{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getVideoDetails, getVideoUrl, getVideoComment } from \"@/api/api\";\nimport { transtime } from \"@/utils/commonApi\";\nexport default {\n  data: function data() {\n    return {\n      mvUrl: \"\",\n      videoUrl: \"\",\n      videoDetail: {\n        creator: {},\n        title: \"\",\n        publishTime: \"\",\n        playTime: \"\",\n        videoGroup: [],\n        praisedCount: \"\",\n        subscribeCount: \"\",\n        shareCount: \"\"\n      },\n      videoId: \"\",\n      videoComments: [],\n      count: \"\",\n      currentPage: 1\n    };\n  },\n  mounted: function mounted() {\n    //缓存id,解决params数据在刷新页面后丢失，导致无法获取到歌单id\n    if (this.$route.params.videoId) {\n      localStorage.setItem(\"videoId\", this.$route.params.videoId);\n    } // 判断是否使用缓存\n\n\n    this.$route.params.videoId ? this.videoId = this.$route.params.videoId : this.videoId = localStorage.getItem(\"videoId\");\n    this.playVideo();\n  },\n  methods: {\n    //mv分页\n    mvhandleCurrentChange: function mvhandleCurrentChange(currentPage) {\n      // console.log(`当前页: ${currentPage}`);\n      this.currentPage = currentPage; // console.log(\"我是第一\"+this.currentPage)\n\n      this.playVideo(this.videoId, currentPage);\n    },\n    playVideo: function playVideo() {\n      var _this = this;\n\n      var params = {\n        id: this.videoId\n      };\n      getVideoDetails(params).then(function (res) {\n        // console.log(\"视频详情--\", res.data.data);\n        _this.videoDetail = res.data.data;\n        _this.videoDetail.publishTime = transtime(_this.videoDetail.publishTime);\n      });\n      getVideoUrl(params).then(function (res) {\n        // console.log(\"视频地址：\", res.data.urls[0].url);\n        _this.videoUrl = res.data.urls[0].url;\n      });\n      var comments = {\n        id: this.videoId,\n        limit: 8,\n        offset: (this.currentPage - 1) * 8\n      };\n      getVideoComment(comments).then(function (res) {\n        // console.log(\"视频评论：\", res);\n        _this.videoComments = res.data.comments;\n        _this.count = res.data.total;\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA;AACA;AACA;AACAA,MADA,kBACA;AACA;AACAC,eADA;AAEAC,kBAFA;AAGAC;AACAC,mBADA;AAEAC,iBAFA;AAGAC,uBAHA;AAIAC,oBAJA;AAKAC,sBALA;AAMAC,wBANA;AAOAC,0BAPA;AAQAC;AARA,OAHA;AAaAC,iBAbA;AAcAC,uBAdA;AAeAC,eAfA;AAgBAC;AAhBA;AAkBA,GApBA;AAqBAC,SArBA,qBAqBA;AACA;AACA;AACAC;AACA,KAJA,CAKA;;;AACA,iCACA,yCADA,GAEA,8CAFA;AAGA;AACA,GA/BA;AAgCAC;AACA;AACAC;AACA;AACA,qCAFA,CAGA;;AACA;AACA,KAPA;AAQAC,aARA,uBAQA;AAAA;;AACA;AACAC;AADA;AAGAC;AACA;AACA;AACA;AACA,OAJA;AAKAC;AACA;AACA;AACA,OAHA;AAIA;AACAF,wBADA;AAEAG,gBAFA;AAGAC;AAHA;AAKAC;AACA;AACA;AACA;AACA,OAJA;AAKA;AA/BA;AAhCA","names":["data","mvUrl","videoUrl","videoDetail","creator","title","publishTime","playTime","videoGroup","praisedCount","subscribeCount","shareCount","videoId","videoComments","count","currentPage","mounted","localStorage","methods","mvhandleCurrentChange","playVideo","id","getVideoDetails","getVideoUrl","limit","offset","getVideoComment"],"sourceRoot":"src/views","sources":["videoPlay.vue"],"sourcesContent":["<template>\n  <!-- 推荐歌单 -->\n  <div class=\"recMv Ocenter\">\n    <!-- <h3 v-if=\"!vid\" class=\"mvTitle\">请先选择需要播放的视频</h3> -->\n    <div v-if=\"videoId\" style=\"margin: 0 auto; width: 95%\">\n      <video\n        controls\n        autoplay\n        loop\n        :src=\"videoUrl\"\n        style=\"margin: 10px 0; width: 100%; height: 580px\"\n      ></video>\n    </div>\n    <div class=\"videoDetail\">\n      <div>\n        <div style=\"margin-bottom: 10px\">\n          <div class=\"authorImg\">\n            <img :src=\"videoDetail.creator.avatarUrl\" alt=\"\" />\n          </div>\n          <span class=\"authorName\">{{ videoDetail.creator.nickname }}</span>\n        </div>\n      </div>\n      <div style=\"margin-bottom: 10px\">\n        <span class=\"videoTitle\">{{ videoDetail.title }}</span>\n      </div>\n      <div style=\"margin-bottom: 10px\">\n        <span class=\"smallFont\">发布：{{ videoDetail.publishTime }}</span>\n        <span class=\"smallFont\">播放：{{ videoDetail.playTime }}次</span>\n      </div>\n      <p>{{ videoDetail.description }}</p>\n      <ul>\n        <li\n          class=\"videoTag\"\n          v-for=\"item in videoDetail.videoGroup\"\n          :key=\"item.id\"\n        >\n          {{ item.name }}\n        </li>\n      </ul>\n      <div>\n        <span class=\"smallFont border\">赞{{ videoDetail.praisedCount }}</span>\n        <span class=\"smallFont border\"\n          >收藏{{ videoDetail.subscribeCount }}</span\n        >\n        <span class=\"smallFont border\">分享{{ videoDetail.shareCount }}</span>\n      </div>\n    </div>\n\n    <div v-if=\"videoId\" style=\"padding: 0px 50px\">\n      <h3 style=\"margin: 5px 0 10px 0; text-align: center\">\n        评论({{ count }}条)\n      </h3>\n      <div class=\"hoverBackColor\" v-for=\"item in videoComments\" :key=\"item.id\">\n        <img\n          :src=\"item.user.avatarUrl\"\n          style=\"width: 50px; border-radius: 25px\"\n        />\n        <span style=\"display: inline-block; margin-left: 10px; font-size: 15px\"\n          >{{ item.user.nickname }}&nbsp;&nbsp;:&nbsp;&nbsp;</span\n        >\n        <span style=\"margin-left: 20px; width: 750px\">\n          {{ item.content }}\n        </span>\n        <div style=\"height: 30px\">\n          <span style=\"float: right; width: 130px\"\n            >&nbsp;&nbsp;时间：{{ item.timeStr }}</span\n          ><span style=\"float: right\"\n            >{{ item.likedCount }} 赞&nbsp;&nbsp;&nbsp;</span\n          >\n        </div>\n      </div>\n      <!-- 评论分页 -->\n      <div style=\"text-align: center\">\n        <el-pagination\n          v-if=\"count != 0\"\n          @current-change=\"mvhandleCurrentChange\"\n          :current-page.sync=\"currentPage\"\n          :page-size=\"8\"\n          layout=\"prev, pager, next, jumper\"\n          :total=\"count\"\n          :background=\"true\"\n        >\n        </el-pagination>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getVideoDetails, getVideoUrl, getVideoComment } from \"@/api/api\";\nimport { transtime } from \"@/utils/commonApi\";\nexport default {\n  data() {\n    return {\n      mvUrl: \"\",\n      videoUrl: \"\",\n      videoDetail: {\n        creator: {},\n        title: \"\",\n        publishTime: \"\",\n        playTime: \"\",\n        videoGroup: [],\n        praisedCount: \"\",\n        subscribeCount: \"\",\n        shareCount: \"\",\n      },\n      videoId: \"\",\n      videoComments: [],\n      count: \"\",\n      currentPage: 1,\n    };\n  },\n  mounted() {\n    //缓存id,解决params数据在刷新页面后丢失，导致无法获取到歌单id\n    if (this.$route.params.videoId) {\n      localStorage.setItem(\"videoId\", this.$route.params.videoId);\n    }\n    // 判断是否使用缓存\n    this.$route.params.videoId\n      ? (this.videoId = this.$route.params.videoId)\n      : (this.videoId = localStorage.getItem(\"videoId\"));\n    this.playVideo();\n  },\n  methods: {\n    //mv分页\n    mvhandleCurrentChange: function (currentPage) {\n      // console.log(`当前页: ${currentPage}`);\n      this.currentPage = currentPage;\n      // console.log(\"我是第一\"+this.currentPage)\n      this.playVideo(this.videoId, currentPage);\n    },\n    playVideo() {\n      let params = {\n        id: this.videoId,\n      };\n      getVideoDetails(params).then((res) => {\n        // console.log(\"视频详情--\", res.data.data);\n        this.videoDetail = res.data.data;\n        this.videoDetail.publishTime = transtime(this.videoDetail.publishTime);\n      });\n      getVideoUrl(params).then((res) => {\n        // console.log(\"视频地址：\", res.data.urls[0].url);\n        this.videoUrl = res.data.urls[0].url;\n      });\n      var comments = {\n        id: this.videoId,\n        limit: 8,\n        offset: (this.currentPage - 1) * 8,\n      };\n      getVideoComment(comments).then((res) => {\n        // console.log(\"视频评论：\", res);\n        this.videoComments = res.data.comments;\n        this.count = res.data.total;\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.recMv {\n  width: 1100px;\n  padding: 0 10px;\n  margin: 10px auto;\n  border-radius: 10px;\n  max-height: 700px;\n  border-radius: 0 0 10px 10px;\n  background: rgba(95, 158, 160, 0.322);\n  overflow-x: hidden;\n\n  &::-webkit-scrollbar {\n    display: none;\n  }\n\n  .mvTitle {\n    height: 30px;\n    line-height: 30px;\n    text-align: center;\n  }\n\n  .recMvwrap {\n    display: flex;\n    justify-content: space-between;\n    flex-wrap: wrap; //根据宽度限制一行的盒子个数\n    margin-bottom: 10px;\n    padding: 10px;\n    border-radius: 10px;\n    background: rgba(95, 158, 160, 0.322);\n  }\n}\n.videoDetail {\n  padding: 10px 50px;\n  // height: 100px;\n  // background: rgb(226, 211, 211);\n  .authorImg {\n    display: inline-block;\n    width: 50px;\n    height: 50px;\n    border-radius: 25px;\n    overflow: hidden;\n    vertical-align: top;\n    img {\n      width: 100%;\n      height: 100%;\n      // vertical-align: top;\n    }\n  }\n  .authorName {\n    display: inline-block;\n    margin-left: 25px;\n    height: 50px;\n    line-height: 50px;\n    font-size: 18px;\n  }\n  .videoTitle {\n    font-size: 20px;\n  }\n  ul {\n    margin: 10px 0;\n    .videoTag {\n      display: inline-block;\n      margin: 0 5px;\n      padding: 2px 5px;\n      background: rgba(231, 217, 192, 0.349);\n      border-radius: 10px;\n    }\n  }\n  .smallFont {\n    margin-right: 10px;\n    height: 20px;\n    line-height: 20px;\n    font-size: 12px;\n    color: rgba(233, 233, 233, 0.829);\n  }\n  .border {\n    margin: 0 5px 0 0;\n    padding: 0 10px;\n    height: 25px;\n    line-height: 25px;\n    font-size: 15px;\n    color: rgb(247, 245, 245);\n    border-radius: 10px;\n    border: 1px solid rgb(248, 245, 245);\n  }\n}\n/deep/ .el-pager {\n  height: 30px !important;\n  background: none !important;\n}\n/deep/ .number,\n/deep/ .btn-prev,\n/deep/ .btn-quicknext,\n/deep/ .btn-next,\n/deep/ .el-input__inner,\n/deep/ .more {\n  color: #f2fff7 !important;\n  background: transparent !important;\n}\n/deep/ .number:hover,\n/deep/ .btn-prev:hover,\n/deep/ .btn-quicknext:hover,\n/deep/ .btn-next:hover,\n/deep/ .el-input__inner:hover,\n/deep/ .more:hover {\n  color: #f7a588 !important;\n}\n/deep/ .active {\n  color: #f7a588 !important;\n}\n/deep/ .el-input__inner {\n  border: none;\n}\n/deep/ .el-pagination__jump {\n  color: #f7dd88 !important;\n}\n</style>"]},"metadata":{},"sourceType":"module"}