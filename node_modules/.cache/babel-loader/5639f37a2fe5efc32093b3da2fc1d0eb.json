{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getVideoDetails, getVideoUrl, getVideoComment } from \"@/api/api\";\nimport { transtime } from \"@/utils/commonApi\";\nexport default {\n  data() {\n    return {\n      mvUrl: \"\",\n      videoUrl: \"\",\n      videoDetail: {\n        creator: {\n          avatarUrl: ''\n        },\n        title: \"\",\n        publishTime: \"\",\n        playTime: \"\",\n        videoGroup: [],\n        praisedCount: \"\",\n        subscribeCount: \"\",\n        shareCount: \"\"\n      },\n      videoId: \"\",\n      videoComments: [],\n      count: \"\",\n      currentPage: 1\n    };\n  },\n\n  mounted() {\n    //缓存id,解决params数据在刷新页面后丢失，导致无法获取到歌单id\n    if (this.$route.params.videoId) {\n      localStorage.setItem(\"videoId\", this.$route.params.videoId);\n    } // 判断是否使用缓存\n\n\n    this.$route.params.videoId ? this.videoId = this.$route.params.videoId : this.videoId = localStorage.getItem(\"videoId\");\n    this.playVideo();\n  },\n\n  methods: {\n    //mv分页\n    mvhandleCurrentChange: function (currentPage) {\n      // console.log(`当前页: ${currentPage}`);\n      this.currentPage = currentPage; // console.log(\"我是第一\"+this.currentPage)\n\n      this.playVideo(this.videoId, currentPage);\n    },\n\n    playVideo() {\n      let params = {\n        id: this.videoId\n      };\n      getVideoDetails(params).then(res => {\n        // console.log(\"视频详情--\", res.data.data);\n        this.videoDetail = res.data.data;\n        this.videoDetail.publishTime = transtime(this.videoDetail.publishTime);\n      });\n      getVideoUrl(params).then(res => {\n        // console.log(\"视频地址：\", res.data.urls[0].url);\n        this.videoUrl = res.data.urls[0].url;\n      });\n      var comments = {\n        id: this.videoId,\n        limit: 8,\n        offset: (this.currentPage - 1) * 8\n      };\n      getVideoComment(comments).then(res => {\n        // console.log(\"视频评论：\", res);\n        this.videoComments = res.data.comments;\n        this.count = res.data.total;\n      });\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}