{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getVideoDetails, getVideoUrl, getVideoComment } from \"@/api/api\";\nimport { transtime } from \"@/utils/commonApi\";\nexport default {\n  data() {\n    return {\n      mvUrl: \"\",\n      videoUrl: \"\",\n      videoDetail: {\n        creator: {},\n        title: \"\",\n        publishTime: \"\",\n        playTime: \"\",\n        videoGroup: [],\n        praisedCount: \"\",\n        subscribeCount: \"\",\n        shareCount: \"\"\n      },\n      videoId: \"\",\n      videoComments: [],\n      count: \"\",\n      currentPage: 1\n    };\n  },\n\n  mounted() {\n    //缓存id,解决params数据在刷新页面后丢失，导致无法获取到歌单id\n    if (this.$route.params.videoId) {\n      localStorage.setItem(\"videoId\", this.$route.params.videoId);\n    } // 判断是否使用缓存\n\n\n    this.$route.params.videoId ? this.videoId = this.$route.params.videoId : this.videoId = localStorage.getItem(\"videoId\");\n    this.playVideo();\n  },\n\n  methods: {\n    //mv分页\n    mvhandleCurrentChange: function (currentPage) {\n      // console.log(`当前页: ${currentPage}`);\n      this.currentPage = currentPage; // console.log(\"我是第一\"+this.currentPage)\n\n      this.playVideo(this.videoId, currentPage);\n    },\n\n    playVideo() {\n      let params = {\n        id: this.videoId\n      };\n      getVideoDetails(params).then(res => {\n        // console.log(\"视频详情--\", res.data.data);\n        this.videoDetail = res.data.data;\n        this.videoDetail.publishTime = transtime(this.videoDetail.publishTime);\n      });\n      getVideoUrl(params).then(res => {\n        // console.log(\"视频地址：\", res.data.urls[0].url);\n        this.videoUrl = res.data.urls[0].url;\n      });\n      var comments = {\n        id: this.videoId,\n        limit: 8,\n        offset: (this.currentPage - 1) * 8\n      };\n      getVideoComment(comments).then(res => {\n        // console.log(\"视频评论：\", res);\n        this.videoComments = res.data.comments;\n        this.count = res.data.total;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA;AACA;AACA;AACAA;AACA;AACAC,eADA;AAEAC,kBAFA;AAGAC;AACAC,mBADA;AAEAC,iBAFA;AAGAC,uBAHA;AAIAC,oBAJA;AAKAC,sBALA;AAMAC,wBANA;AAOAC,0BAPA;AAQAC;AARA,OAHA;AAaAC,iBAbA;AAcAC,uBAdA;AAeAC,eAfA;AAgBAC;AAhBA;AAkBA,GApBA;;AAqBAC;AACA;AACA;AACAC;AACA,KAJA,CAKA;;;AACA,iCACA,yCADA,GAEA,8CAFA;AAGA;AACA,GA/BA;;AAgCAC;AACA;AACAC;AACA;AACA,qCAFA,CAGA;;AACA;AACA,KAPA;;AAQAC;AACA;AACAC;AADA;AAGAC;AACA;AACA;AACA;AACA,OAJA;AAKAC;AACA;AACA;AACA,OAHA;AAIA;AACAF,wBADA;AAEAG,gBAFA;AAGAC;AAHA;AAKAC;AACA;AACA;AACA;AACA,OAJA;AAKA;;AA/BA;AAhCA","names":["data","mvUrl","videoUrl","videoDetail","creator","title","publishTime","playTime","videoGroup","praisedCount","subscribeCount","shareCount","videoId","videoComments","count","currentPage","mounted","localStorage","methods","mvhandleCurrentChange","playVideo","id","getVideoDetails","getVideoUrl","limit","offset","getVideoComment"],"sourceRoot":"src/views/videoPlay","sources":["videoPlay.vue"],"sourcesContent":["<template>\r\n  <!-- 推荐歌单 -->\r\n  <div class=\"recMv Ocenter\">\r\n    <!-- <h3 v-if=\"!vid\" class=\"mvTitle\">请先选择需要播放的视频</h3> -->\r\n    <div v-if=\"videoId\" style=\"margin: 0 auto; width: 95%\">\r\n      <video\r\n        controls\r\n        autoplay\r\n        loop\r\n        :src=\"videoUrl\"\r\n        style=\"margin: 10px 0; width: 100%; height: 580px\"\r\n      ></video>\r\n    </div>\r\n    <div class=\"videoDetail\">\r\n      <div>\r\n        <div style=\"margin-bottom: 10px\">\r\n          <div class=\"authorImg\">\r\n            <img :src=\"videoDetail.creator.avatarUrl\" alt=\"\" />\r\n          </div>\r\n          <span class=\"authorName\">{{ videoDetail.creator.nickname }}</span>\r\n        </div>\r\n      </div>\r\n      <div style=\"margin-bottom: 10px\">\r\n        <span class=\"videoTitle\">{{ videoDetail.title }}</span>\r\n      </div>\r\n      <div style=\"margin-bottom: 10px\">\r\n        <span class=\"smallFont\">发布：{{ videoDetail.publishTime }}</span>\r\n        <span class=\"smallFont\">播放：{{ videoDetail.playTime }}次</span>\r\n      </div>\r\n      <p>{{ videoDetail.description }}</p>\r\n      <ul>\r\n        <li\r\n          class=\"videoTag\"\r\n          v-for=\"item in videoDetail.videoGroup\"\r\n          :key=\"item.id\"\r\n        >\r\n          {{ item.name }}\r\n        </li>\r\n      </ul>\r\n      <div>\r\n        <span class=\"smallFont border\">赞{{ videoDetail.praisedCount }}</span>\r\n        <span class=\"smallFont border\"\r\n          >收藏{{ videoDetail.subscribeCount }}</span\r\n        >\r\n        <span class=\"smallFont border\">分享{{ videoDetail.shareCount }}</span>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-if=\"videoId\" style=\"padding: 0px 50px\">\r\n      <h3 style=\"margin: 5px 0 10px 0; text-align: center\">\r\n        评论({{ count }}条)\r\n      </h3>\r\n      <div class=\"hoverBackColor\" v-for=\"item in videoComments\" :key=\"item.id\">\r\n        <img\r\n          :src=\"item.user.avatarUrl\"\r\n          style=\"width: 50px; border-radius: 25px\"\r\n        />\r\n        <span style=\"display: inline-block; margin-left: 10px; font-size: 15px\"\r\n          >{{ item.user.nickname }}&nbsp;&nbsp;:&nbsp;&nbsp;</span\r\n        >\r\n        <span style=\"margin-left: 20px; width: 750px\">\r\n          {{ item.content }}\r\n        </span>\r\n        <div style=\"height: 30px\">\r\n          <span style=\"float: right; width: 130px\"\r\n            >&nbsp;&nbsp;时间：{{ item.timeStr }}</span\r\n          ><span style=\"float: right\"\r\n            >{{ item.likedCount }} 赞&nbsp;&nbsp;&nbsp;</span\r\n          >\r\n        </div>\r\n      </div>\r\n      <!-- 评论分页 -->\r\n      <div style=\"text-align: center\">\r\n        <el-pagination\r\n          v-if=\"count != 0\"\r\n          @current-change=\"mvhandleCurrentChange\"\r\n          :current-page.sync=\"currentPage\"\r\n          :page-size=\"8\"\r\n          layout=\"prev, pager, next, jumper\"\r\n          :total=\"count\"\r\n          :background=\"true\"\r\n        >\r\n        </el-pagination>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getVideoDetails, getVideoUrl, getVideoComment } from \"@/api/api\";\r\nimport { transtime } from \"@/utils/commonApi\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      mvUrl: \"\",\r\n      videoUrl: \"\",\r\n      videoDetail: {\r\n        creator: {},\r\n        title: \"\",\r\n        publishTime: \"\",\r\n        playTime: \"\",\r\n        videoGroup: [],\r\n        praisedCount: \"\",\r\n        subscribeCount: \"\",\r\n        shareCount: \"\",\r\n      },\r\n      videoId: \"\",\r\n      videoComments: [],\r\n      count: \"\",\r\n      currentPage: 1,\r\n    };\r\n  },\r\n  mounted() {\r\n    //缓存id,解决params数据在刷新页面后丢失，导致无法获取到歌单id\r\n    if (this.$route.params.videoId) {\r\n      localStorage.setItem(\"videoId\", this.$route.params.videoId);\r\n    }\r\n    // 判断是否使用缓存\r\n    this.$route.params.videoId\r\n      ? (this.videoId = this.$route.params.videoId)\r\n      : (this.videoId = localStorage.getItem(\"videoId\"));\r\n    this.playVideo();\r\n  },\r\n  methods: {\r\n    //mv分页\r\n    mvhandleCurrentChange: function (currentPage) {\r\n      // console.log(`当前页: ${currentPage}`);\r\n      this.currentPage = currentPage;\r\n      // console.log(\"我是第一\"+this.currentPage)\r\n      this.playVideo(this.videoId, currentPage);\r\n    },\r\n    playVideo() {\r\n      let params = {\r\n        id: this.videoId,\r\n      };\r\n      getVideoDetails(params).then((res) => {\r\n        // console.log(\"视频详情--\", res.data.data);\r\n        this.videoDetail = res.data.data;\r\n        this.videoDetail.publishTime = transtime(this.videoDetail.publishTime);\r\n      });\r\n      getVideoUrl(params).then((res) => {\r\n        // console.log(\"视频地址：\", res.data.urls[0].url);\r\n        this.videoUrl = res.data.urls[0].url;\r\n      });\r\n      var comments = {\r\n        id: this.videoId,\r\n        limit: 8,\r\n        offset: (this.currentPage - 1) * 8,\r\n      };\r\n      getVideoComment(comments).then((res) => {\r\n        // console.log(\"视频评论：\", res);\r\n        this.videoComments = res.data.comments;\r\n        this.count = res.data.total;\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.recMv {\r\n  width: 1100px;\r\n  padding: 0 10px;\r\n  margin: 10px auto;\r\n  border-radius: 10px;\r\n  max-height: 700px;\r\n  border-radius: 0 0 10px 10px;\r\n  background: rgba(95, 158, 160, 0.322);\r\n  overflow-x: hidden;\r\n\r\n  &::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n\r\n  .mvTitle {\r\n    height: 30px;\r\n    line-height: 30px;\r\n    text-align: center;\r\n  }\r\n\r\n  .recMvwrap {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    flex-wrap: wrap; //根据宽度限制一行的盒子个数\r\n    margin-bottom: 10px;\r\n    padding: 10px;\r\n    border-radius: 10px;\r\n    background: rgba(95, 158, 160, 0.322);\r\n  }\r\n}\r\n.videoDetail {\r\n  padding: 10px 50px;\r\n  // height: 100px;\r\n  // background: rgb(226, 211, 211);\r\n  .authorImg {\r\n    display: inline-block;\r\n    width: 50px;\r\n    height: 50px;\r\n    border-radius: 25px;\r\n    overflow: hidden;\r\n    vertical-align: top;\r\n    img {\r\n      width: 100%;\r\n      height: 100%;\r\n      // vertical-align: top;\r\n    }\r\n  }\r\n  .authorName {\r\n    display: inline-block;\r\n    margin-left: 25px;\r\n    height: 50px;\r\n    line-height: 50px;\r\n    font-size: 18px;\r\n  }\r\n  .videoTitle {\r\n    font-size: 20px;\r\n  }\r\n  ul {\r\n    margin: 10px 0;\r\n    .videoTag {\r\n      display: inline-block;\r\n      margin: 0 5px;\r\n      padding: 2px 5px;\r\n      background: rgba(231, 217, 192, 0.349);\r\n      border-radius: 10px;\r\n    }\r\n  }\r\n  .smallFont {\r\n    margin-right: 10px;\r\n    height: 20px;\r\n    line-height: 20px;\r\n    font-size: 12px;\r\n    color: rgba(233, 233, 233, 0.829);\r\n  }\r\n  .border {\r\n    margin: 0 5px 0 0;\r\n    padding: 0 10px;\r\n    height: 25px;\r\n    line-height: 25px;\r\n    font-size: 15px;\r\n    color: rgb(247, 245, 245);\r\n    border-radius: 10px;\r\n    border: 1px solid rgb(248, 245, 245);\r\n  }\r\n}\r\n/deep/ .el-pager {\r\n  height: 30px !important;\r\n  background: none !important;\r\n}\r\n/deep/ .number,\r\n/deep/ .btn-prev,\r\n/deep/ .btn-quicknext,\r\n/deep/ .btn-next,\r\n/deep/ .el-input__inner,\r\n/deep/ .more {\r\n  color: #f2fff7 !important;\r\n  background: transparent !important;\r\n}\r\n/deep/ .number:hover,\r\n/deep/ .btn-prev:hover,\r\n/deep/ .btn-quicknext:hover,\r\n/deep/ .btn-next:hover,\r\n/deep/ .el-input__inner:hover,\r\n/deep/ .more:hover {\r\n  color: #f7a588 !important;\r\n}\r\n/deep/ .active {\r\n  color: #f7a588 !important;\r\n}\r\n/deep/ .el-input__inner {\r\n  border: none;\r\n}\r\n/deep/ .el-pagination__jump {\r\n  color: #f7dd88 !important;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}