{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getMusicInfo } from \"@/api/api\";\nimport { transMusicTime, transPlayCount } from \"@/utils/commonApi\";\nimport songlist from \"@/components/songlist.vue\";\nexport default {\n  components: {\n    songlist\n  },\n\n  data() {\n    return {\n      //试听音乐\n      listen: [],\n      //单曲，专辑，歌手，歌单开关\n      tagSwitch: {},\n      //MV列表\n      videoList: [],\n      //歌单列表\n      playListTable: [],\n      // 歌曲列表\n      musicList: [],\n      // 专辑列表\n      albumList: [],\n      //歌手列表\n      artists: [],\n      //MV列表\n      mvList: [],\n      //音乐下载地址\n      downLoadUrl: \"\",\n      //标签切换\n      activeName: \"first\",\n      //搜索内容总数（歌曲，歌单，mv,等）\n      count: 0,\n      //初始页\n      currentPage: 1\n    };\n  },\n\n  created() {\n    // console.log(this);\n    var that = this;\n    that.tagSwitch = that.$store.state.musicPlayList.tagSwitch;\n    that.search();\n  },\n\n  methods: {\n    //标签切换\n    tagSelect(tag) {\n      var that = this;\n      that.$store.commit(\"musicPlayList/tagSelect\", tag);\n      that.$nextTick(() => {\n        that.search();\n      });\n    },\n\n    //分页\n    handleCurrentChange: function (currentPage) {\n      // console.log(`当前页: ${currentPage}`);\n      this.currentPage = currentPage;\n      var that = this;\n\n      if (that.tagSwitch.songSwitch) {\n        that.getSingleMuscic();\n      } else if (that.tagSwitch.playListSwitch) {\n        that.getMusicList();\n      } else if (that.tagSwitch.videoSwitch) {\n        that.getVideoList();\n      } else if (that.tagSwitch.mvSwitch) {\n        that.getMVList();\n      } else if (that.tagSwitch.singerSwitch) {\n        that.getSingerList();\n      } else if (that.tagSwitch.albumSwitch) {\n        that.getSingerList();\n      }\n    },\n\n    search() {\n      var that = this;\n\n      if (that.tagSwitch.songSwitch) {\n        that.getSingleMuscic();\n      } else if (that.tagSwitch.playListSwitch) {\n        that.getMusicList();\n      } else if (that.tagSwitch.videoSwitch) {\n        that.getVideoList();\n      } else if (that.tagSwitch.mvSwitch) {\n        that.getMVList();\n      } else if (that.tagSwitch.singerSwitch) {\n        that.getSingerList();\n      } else if (that.tagSwitch.albumSwitch) {\n        that.getAlbumList();\n      }\n    },\n\n    //获取专辑详情\n    goAlbumDetail(albumDesc) {\n      let params = {\n        id: albumDesc.id,\n        name: albumDesc.name,\n        blurPicUrl: albumDesc.blurPicUrl,\n        size: albumDesc.size,\n        artist: {\n          name: albumDesc.artist.name,\n          img1v1Url: albumDesc.artist.img1v1Url\n        }\n      };\n      this.$router.push({\n        name: \"albumDetail\",\n        params: {\n          albumDesc: params\n        }\n      });\n    },\n\n    //进入歌手详情页面\n    goSingerDetail(singerDetail) {\n      // console.log(item)\n      let params = {\n        id: singerDetail.id,\n        img1v1Url: singerDetail.img1v1Url,\n        name: singerDetail.name,\n        alias: singerDetail.alias,\n        musicSize: singerDetail.musicSize,\n        albumSize: singerDetail.albumSize,\n        mvSize: singerDetail.mvSize,\n        briefDesc: \"\"\n      };\n      this.$router.push({\n        name: \"singerDetail\",\n        params: {\n          artist: params\n        }\n      });\n    },\n\n    //进入歌单详情\n    goSongList(playListDetail) {\n      // console.log(playListDetail);\n      let params = {\n        id: playListDetail.id,\n        name: playListDetail.name,\n        coverImgUrl: playListDetail.coverImgUrl,\n        trackCount: playListDetail.trackCount,\n        creator: {\n          avatarUrl: '',\n          nickname: playListDetail.creator.nickname,\n          signature: \"\"\n        },\n        tags: [] // description: \"\",\n\n      }; //传入歌单id进入歌单详情\n\n      this.$router.push({\n        name: \"playListDetails\",\n        params: {\n          playListDetail: params\n        }\n      });\n    },\n\n    //通过搜索关键词获取单曲（歌曲）\n    getSingleMuscic() {\n      var that = this;\n\n      if (that.$route.query.reload) {// console.log(\"this.$route:---\", that.$route);\n      } //获取歌曲列表\n\n\n      let params = {\n        keywords: that.$route.query.keywords,\n        limit: 30,\n        offset: (that.currentPage - 1) * 30,\n        type: 1 //代表获取单曲\n\n      };\n      that.musicList = [];\n      getMusicInfo(params).then(async res => {\n        that.musicList = await res.data.result.songs; // console.log(that.musicList)\n\n        that.count = await res.data.result.songCount;\n        transMusicTime(that.musicList, \"dt\"); // console.log(\"音乐列表：\", res.data.result);\n        //给每个列表添加一个防抖\n\n        for (let item of that.musicList) {\n          that.$set(item, \"timer\", true);\n        }\n      });\n    },\n\n    // 通过搜索关键词获取专辑\n    getAlbumList() {\n      var that = this; //获取歌曲列表\n\n      let params = {\n        keywords: that.$route.query.keywords,\n        limit: 30,\n        offset: (that.currentPage - 1) * 30,\n        type: 10 //代表获取专辑\n\n      };\n      that.albumList = [];\n      getMusicInfo(params).then(res => {\n        that.albumList = res.data.result.albums;\n        that.count = res.data.result.albumCount; // console.log(\"专辑列表：\", res.data.result);\n      });\n    },\n\n    //通过搜索关键词获取歌手列表\n    getSingerList() {\n      var that = this;\n      let params = {\n        keywords: that.$route.query.keywords,\n        limit: 15,\n        offset: (that.currentPage - 1) * 15,\n        type: 100 //代表获取歌手\n\n      };\n      that.artists = [];\n      getMusicInfo(params).then(res => {\n        // console.log(\"获取歌手列表----\", res.data.result);\n        that.artists = res.data.result.artists;\n        that.count = res.data.result.artistCount;\n      });\n    },\n\n    //通过搜索关键词获取歌单\n    getMusicList() {\n      var that = this;\n      let params = {\n        keywords: that.$route.query.keywords,\n        limit: 15,\n        offset: (that.currentPage - 1) * 15,\n        type: 1000 //代表获取歌单\n\n      };\n      that.playListTable = [];\n      getMusicInfo(params).then(async res => {\n        // console.log('获取歌单列表----', res.data.result)\n        that.playListTable = await res.data.result.playlists;\n        that.count = await res.data.result.playlistCount;\n        transPlayCount(that.playListTable, \"playCount\");\n      });\n    },\n\n    //通过搜索关键词获取对应视频列表\n    getVideoList() {\n      var that = this;\n      let params = {\n        keywords: that.$route.query.keywords,\n        limit: 12,\n        offset: (that.currentPage - 1) * 12,\n        type: 1014 //代表获取视频\n\n      };\n      that.videoList = [];\n      getMusicInfo(params).then(async res => {\n        // console.log(\"获取视频列表----\", res.data.result);\n        that.videoList = await res.data.result.videos; // console.log(\"视频列表：\", that.videoList);\n\n        that.count = await res.data.result.videoCount; //转换歌曲时长单位为分秒\n\n        transMusicTime(that.videoList, \"durationms\"); //将播放量转换成亿万单位\n\n        transPlayCount(that.videoList, \"playTime\");\n      });\n    },\n\n    //通过搜索关键词获取对应MV列表\n    getMVList() {\n      var that = this;\n      let params = {\n        keywords: that.$route.query.keywords,\n        limit: 12,\n        offset: (that.currentPage - 1) * 12,\n        type: 1004 //代表获取MV\n\n      };\n      that.mvList = [];\n      getMusicInfo(params).then(async res => {\n        // console.log(\"获取MV列表----\", res.data.result);\n        that.mvList = await res.data.result.mvs; // console.log(\"MV列表：\", that.mvList);\n\n        that.count = await res.data.result.mvCount; //转换歌曲时间为分秒单位\n\n        transMusicTime(that.mvList, \"duration\"); // 转换播放量单位为万\n\n        transPlayCount(that.mvList, \"playCount\");\n      });\n    },\n\n    goVideo(vid, type) {\n      if (type === 0) {\n        this.$router.push({\n          name: \"mvPlay\",\n          params: {\n            mvId: vid\n          }\n        });\n      } else {\n        this.$router.push({\n          name: \"videoPlay\",\n          params: {\n            videoId: vid\n          }\n        });\n      }\n    },\n\n    randomColor() {\n      return `#${(Math.random() * 0xffffff << 0).toString(16)}`;\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}