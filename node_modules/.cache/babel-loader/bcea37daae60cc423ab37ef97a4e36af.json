{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getHotPlayList, getAllPlayList, getPlaylist } from \"@/api/api\";\nimport { transPlayCount } from \"@/utils/commonApi\";\nexport default {\n  data() {\n    return {\n      hotPlaylistTag: [],\n      categaryShow: false,\n      order: \"最新\",\n      currentTag: \"全部\",\n      categories: {},\n      categoryTag: {\n        0: [],\n        1: [],\n        2: [],\n        3: [],\n        4: []\n      },\n      playListTable: [],\n      count: 0,\n      //初始页\n      currentPage: 1\n    };\n  },\n\n  watch: {\n    //排列顺序发生变化时，自动获取\n    order() {\n      this.getPlaylist(this.currentTag);\n    }\n\n  },\n\n  mounted() {\n    this.getHotPlayList();\n    this.getAllPlayList();\n    this.getPlaylist(this.currentTag);\n  },\n\n  methods: {\n    //获取热门分类歌单\n    getHotPlayList() {\n      let that = this;\n      getHotPlayList().then(res => {\n        that.hotPlaylistTag = res.data.tags;\n      });\n    },\n\n    //获取全部歌单分类\n    getAllPlayList() {\n      let that = this;\n      getAllPlayList().then(async res => {\n        // console.log(res)\n        that.categories = await res.data.categories;\n\n        for (let key in that.categoryTag) {\n          res.data.sub.forEach(item => {\n            if (item.category == key) {\n              that.categoryTag[key].push(item); // console.log(that.categoryTag)\n            }\n          });\n        }\n      });\n    },\n\n    //获取歌单列表----\n    getPlaylist(cat, notChangePage) {\n      let that = this;\n      let params = {\n        cat: cat,\n        order: that.order,\n        limit: 15,\n        offset: (that.currentPage - 1) * 15\n      };\n      that.categaryShow = false;\n      if (that.currentTag === cat && notChangePage) return;\n      that.playListTable = []; //清空，重新获取，防止页面图片加载慢\n\n      that.currentTag = cat;\n      getPlaylist(params).then(async res => {\n        // console.log(res)\n        that.playListTable = await res.data.playlists; // console.log(that.playListTable)\n\n        that.count = await res.data.total; // transPlayCount(that.playListTable)\n\n        transPlayCount(that.playListTable, \"playCount\");\n      });\n    },\n\n    //传入歌单id进入歌单详情\n    goSongList(songListDetail) {\n      //传入歌单id进入歌单详情\n      // console.log(\"歌单详情\", songListDetail);\n      var that = this;\n      that.$router.push({\n        name: \"playListDetails\",\n        params: {\n          playListDetail: songListDetail\n        }\n      });\n    },\n\n    //分页\n    handleCurrentChange: function (currentPage) {\n      // console.log(`当前页: ${currentPage}`);\n      var that = this;\n      that.currentPage = currentPage;\n      that.getPlaylist(that.currentTag, false);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}